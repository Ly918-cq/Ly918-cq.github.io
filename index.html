<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>仂昭国际贸易（重庆）有限公司</title>
    <style>
        /* 页面基础样式 */
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #0366d6;
            font-size: 28px;
            text-align: center;
            margin-bottom: 20px;
        }
        .desc {
            text-align: center;
            font-size: 16px;
            margin-bottom: 30px;
        }
        /* PDF 容器样式 */
        #pdf-container {
            width: 100%;
            min-height: 800px;
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: auto;
            padding: 20px;
        }
        /* 加载提示样式 */
        .loading {
            text-align: center;
            font-size: 18px;
            color: #666;
            padding: 50px 0;
        }
        .error {
            text-align: center;
            font-size: 18px;
            color: red;
            padding: 50px 0;
        }
        /* 翻页按钮样式 */
        .page-controls {
            text-align: center;
            margin: 20px 0;
        }
        .page-btn {
            padding: 8px 16px;
            margin: 0 5px;
            background-color: #0366d6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .page-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
    <!-- 引入 PDF.js 库（国内CDN，加载更快） -->
    <script src="https://cdn.staticfile.org/pdf.js/3.11.174/pdf.min.js"></script>
</head>
<body>
    <h1>仂昭国际贸易（重庆）有限公司</h1>
    <p class="desc">专注于中国-东盟农产品贸易，提供柑橘等农产品进出口服务</p>

    <!-- 翻页按钮 -->
    <div class="page-controls">
        <button id="prev-btn" class="page-btn" disabled>上一页</button>
        <span id="page-info">第 1 页 / 总 0 页</span>
        <button id="next-btn" class="page-btn" disabled>下一页</button>
    </div>

    <!-- PDF 显示容器 -->
    <div id="pdf-container">
        <div class="loading">正在加载 PDF，请稍候...（文件较大，可能需要几秒）</div>
    </div>

    <script>
        // 配置 PDF.js
        const pdfjsLib = window['pdfjs-dist/build/pdf'];
        // 使用国内CDN的worker，避免加载失败
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.staticfile.org/pdf.js/3.11.174/pdf.worker.min.js';

        // 关键修改：使用GitHub Pages的同域路径，不是raw链接！
        // 因为你的仓库是 Ly918-cq.github.io，所以直接写文件名即可
        const pdfUrl = 'Natcropp.pdf';

        // 全局变量
        let pdfDoc = null;
        let currentPage = 1;
        let totalPages = 0;

        // 获取DOM元素
        const container = document.getElementById('pdf-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const pageInfo = document.getElementById('page-info');

        // 渲染指定页码的PDF
        async function renderPage(pageNum) {
            try {
                // 清空容器
                container.innerHTML = '';

                // 获取当前页
                const page = await pdfDoc.getPage(pageNum);

                // 设置渲染尺寸（适配屏幕）
                const viewport = page.getViewport({ 
                    scale: Math.min(window.innerWidth / page.getViewport({ scale: 1 }).width, 1.5)
                });

                // 创建canvas用于渲染
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                container.appendChild(canvas);

                // 渲染PDF内容
                await page.render({
                    canvasContext: ctx,
                    viewport: viewport
                }).promise;

                // 更新页码信息
                currentPage = pageNum;
                pageInfo.textContent = `第 ${currentPage} 页 / 总 ${totalPages} 页`;

                // 更新按钮状态
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages;

            } catch (error) {
                container.innerHTML = `<div class="error">渲染第 ${pageNum} 页失败：${error.message}</div>`;
            }
        }

        // 初始化PDF
        async function initPdf() {
            try {
                // 加载PDF文档（处理大文件）
                const loadingTask = pdfjsLib.getDocument({
                    url: pdfUrl,
                    cMapUrl: 'https://cdn.staticfile.org/pdf.js/3.11.174/cmaps/', // 解决中文乱码
                    cMapPacked: true,
                    disableFontFace: true // 优化大文件加载
                });

                pdfDoc = await loadingTask.promise;
                totalPages = pdfDoc.numPages;

                // 更新页码信息
                pageInfo.textContent = `第 1 页 / 总 ${totalPages} 页`;

                // 启用翻页按钮
                if (totalPages > 1) {
                    nextBtn.disabled = false;
                }

                // 渲染第一页
                await renderPage(1);

            } catch (error) {
                container.innerHTML = `<div class="error">PDF加载失败！原因：${error.message}<br>请检查 Natcropp.pdf 文件是否已上传到仓库根目录</div>`;
                console.error('PDF加载失败详情：', error);
            }
        }

        // 绑定按钮事件
        prevBtn.addEventListener('click', () => {
            if (currentPage > 1) {
                renderPage(currentPage - 1);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentPage < totalPages) {
                renderPage(currentPage + 1);
            }
        });

        // 页面加载完成后初始化PDF
        window.onload = initPdf;

        // 窗口大小变化时重新渲染
        window.addEventListener('resize', () => {
            if (pdfDoc) {
                renderPage(currentPage);
            }
        });
    </script>
</body>
</html>
